-- ✅ Services
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local playerGui = player:FindFirstChild("PlayerGui")

-- ✅ State
local uiVisibilityState = {}
local afkMode = false
local fpsLimit = 10

-- ✅ Simpan state awal GUI
if playerGui then
    for _, gui in pairs(playerGui:GetChildren()) do
        if gui:IsA("ScreenGui") then
            uiVisibilityState[gui] = gui.Enabled
        end
    end
end

-- ✅ Toggle Rendering
local function toggleRendering(state)
    RunService:Set3dRenderingEnabled(state)
    print(state and "✅ 3D Rendering Enabled!" or "❌ 3D Rendering Disabled!")
end

-- ✅ Toggle UI
local function toggleUI(state)
    StarterGui:SetCore("TopbarEnabled", state)

    if playerGui then
        for _, gui in pairs(playerGui:GetChildren()) do
            if gui:IsA("ScreenGui") then
                gui.Enabled = state and (uiVisibilityState[gui] or false)
            end
        end
    end

    print(state and "✅ UI Enabled!" or "❌ UI Disabled!")
end

-- ✅ Set FPS Cap
local function setFPSLimit(fps)
    if setfpscap then
        setfpscap(fps)  
        print("✅ FPS Limit set to " .. fps)
    else
        warn("Executor does not support setfpscap!")
    end
end

-- ✅ Toggle AFK Mode
local function toggleAFKMode(state)
    afkMode = state
    toggleRendering(not afkMode)
    toggleUI(not afkMode)
    setFPSLimit(15)
end

-- ✅ Pastikan awalnya aktif
toggleUI(true)
toggleRendering(true)

-- ✅ Tombol L untuk AFK
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.L then
        toggleAFKMode(not afkMode)
    end
end)

-- ✅ Contoh set FPS langsung (opsional)
